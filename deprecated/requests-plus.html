<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Apicase | Requests+</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/14.styles.069008a2.css" as="style"><link rel="preload" href="/assets/js/app.8395491c.js" as="script"><link rel="preload" href="/assets/js/4.63f4dde3.js" as="script"><link rel="prefetch" href="/assets/js/6.116cf7b6.js"><link rel="prefetch" href="/assets/js/0.2ef4af48.js"><link rel="prefetch" href="/assets/js/1.fcd4327d.js"><link rel="prefetch" href="/assets/js/2.5faf6c39.js"><link rel="prefetch" href="/assets/js/3.278799db.js"><link rel="prefetch" href="/assets/js/5.42f78ee0.js"><link rel="prefetch" href="/assets/js/7.ca515bf6.js"><link rel="prefetch" href="/assets/js/8.80949565.js"><link rel="prefetch" href="/assets/js/9.66a23df4.js"><link rel="prefetch" href="/assets/js/10.a00d6c64.js"><link rel="prefetch" href="/assets/js/11.a5f43c96.js"><link rel="prefetch" href="/assets/js/12.9018ccc1.js"><link rel="prefetch" href="/assets/js/13.40d0899f.js">
    <link rel="stylesheet" href="/assets/css/14.styles.069008a2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      Apicase
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><!----></div></header><div class="sidebar-mask"></div><div class="sidebar"><!----><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>Apicase</span><!----></p><ul class="sidebar-group-items"><li><a href="/" class="sidebar-link">Introduction</a></li><li><a href="/installation.html" class="sidebar-link">Installation</a></li><li><a href="/quick-start.html" class="sidebar-link">Quick start</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Anatomy</span><!----></p><ul class="sidebar-group-items"><li><a href="/anatomy/requests.html" class="sidebar-link">Requests</a></li><li><a href="/anatomy/services.html" class="sidebar-link">Services</a></li><li><a href="/anatomy/spawner.html" class="sidebar-link">Spawner API</a></li><li><a href="/anatomy/adapters.html" class="sidebar-link">Adapters</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Migration info</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>Deprecated APIs</span><span class="arrow down"></span></p><ul class="sidebar-group-items"><li><a href="/deprecated/queues.html" class="sidebar-link">Requests queues</a></li><li><a href="/deprecated/requests-plus.html" class="active sidebar-link">Requests+</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deprecated/requests-plus.html#manually-start-requests" class="sidebar-link">Manually start requests</a></li><li class="sidebar-sub-header"><a href="/deprecated/requests-plus.html#requests-delay-debounce-timeout" class="sidebar-link">Requests delay/debounce/timeout</a></li></ul></li></ul></div></li></ul></div><div class="page"><div class="content"><h1 id="requests"><a href="#requests" aria-hidden="true" class="header-anchor">#</a> Requests+</h1><div class="danger custom-block"><p class="custom-block-title">Deprecated</p><p><strong>Requests+</strong> are removed in <strong>0.15</strong><br>
Use <a href="/anatomy/spawner.html"><strong>Spawner API</strong></a> instead</p></div><p>Here you can find info that I decided to talk about later</p><h2 id="manually-start-requests"><a href="#manually-start-requests" aria-hidden="true" class="header-anchor">#</a> Manually start requests</h2><h4 id="how-to-use"><a href="#how-to-use" aria-hidden="true" class="header-anchor">#</a> How to use</h4><p>Apicase has option to create request but start it manually.</p><pre class="language-javascript"><code><span class="token keyword">const</span> req <span class="token operator">=</span> <span class="token function">doRequest</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token punctuation">:</span> <span class="token string">'/api/posts'</span><span class="token punctuation">,</span>
  options<span class="token punctuation">:</span> <span class="token punctuation">{</span> immediate<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">/* Then start it */</span>
req<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><p>Also, you can pass <code>payload</code> to <code>.start()</code> method to change payload:</p><pre class="language-javascript"><code><span class="token keyword">const</span> req <span class="token operator">=</span> <span class="token function">doRequest</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token punctuation">:</span> <span class="token string">'/api/posts'</span><span class="token punctuation">,</span>
  method<span class="token punctuation">:</span> <span class="token string">'POST'</span>
  options<span class="token punctuation">:</span> <span class="token punctuation">{</span> immediate<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">/* Change url */</span>
req<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">{</span> url<span class="token punctuation">:</span> <span class="token string">'/api/another'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="warning custom-block"><p class="custom-block-title">Note</p><p>Note that <code>.start()</code> method will <strong>fully replace</strong> payload, <strong>not merge</strong><br>
Also, it replaces <strong>payload only</strong>, not meta/hooks/options/etc</p></div><p>You still can add event listeners to request that hasn't started yet:</p><pre class="language-javascript"><code><span class="token keyword">const</span> req <span class="token operator">=</span> <span class="token function">doRequest</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token punctuation">:</span> <span class="token string">'/api/posts'</span><span class="token punctuation">,</span>
  options<span class="token punctuation">:</span> <span class="token punctuation">{</span> immediate<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">,</span> console<span class="token punctuation">.</span>log<span class="token punctuation">)</span>
</code></pre><p>But you can't use <code>async/await</code> because request promise is not created yet.</p><pre class="language-javascript"><code><span class="token comment">/* No error thrown, but this one will never be resolved */</span>
<span class="token keyword">await</span> <span class="token function">doRequest</span><span class="token punctuation">(</span><span class="token punctuation">{</span> 
  url<span class="token punctuation">:</span> <span class="token string">'/api/posts'</span><span class="token punctuation">,</span> 
  options<span class="token punctuation">:</span> <span class="token punctuation">{</span> immediate<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">/* Instead, await request after .start() */</span>
<span class="token keyword">await</span> request<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><h2 id="requests-delay-debounce-timeout"><a href="#requests-delay-debounce-timeout" aria-hidden="true" class="header-anchor">#</a> Requests delay/debounce/timeout</h2><h4 id="debounced-request"><a href="#debounced-request" aria-hidden="true" class="header-anchor">#</a> Debounced request</h4><p>Imagine that we have some search field with autocomplete from server. And we want to add delay for that request. Also we want to abort request on input change. We can create debounced request using <code>options.debounce</code></p><pre class="language-javascript"><code><span class="token keyword">const</span> search <span class="token operator">=</span> <span class="token function">doRequest</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token punctuation">:</span> <span class="token string">'/search'</span><span class="token punctuation">,</span>
  method<span class="token punctuation">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>
  options<span class="token punctuation">:</span> <span class="token punctuation">{</span> immediate<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> debounce<span class="token punctuation">:</span> <span class="token number">500</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><p>Then,  you have to start request:</p><pre class="language-javascript"><code><span class="token comment">/* .start() resets timer and starts again */</span>
search<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">{</span> body<span class="token punctuation">:</span> <span class="token punctuation">{</span> text<span class="token punctuation">:</span> <span class="token string">'Search text 1'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
search<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">{</span> body<span class="token punctuation">:</span> <span class="token punctuation">{</span> text<span class="token punctuation">:</span> <span class="token string">'Search text 2'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
search<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">{</span> body<span class="token punctuation">:</span> <span class="token punctuation">{</span> text<span class="token punctuation">:</span> <span class="token string">'Search text 3'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
search<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">{</span> body<span class="token punctuation">:</span> <span class="token punctuation">{</span> text<span class="token punctuation">:</span> <span class="token string">'Search text 4'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
search<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">{</span> body<span class="token punctuation">:</span> <span class="token punctuation">{</span> text<span class="token punctuation">:</span> <span class="token string">'Search text 5'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><h4 id="delayed-request"><a href="#delayed-request" aria-hidden="true" class="header-anchor">#</a> Delayed request</h4><p>If you need to use delay only (without debounce), use <code>options.delay</code> instead</p><pre class="language-javascript"><code><span class="token keyword">const</span> delayed <span class="token operator">=</span> <span class="token function">doRequest</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token punctuation">:</span> <span class="token string">'/delayed'</span><span class="token punctuation">,</span>
  options<span class="token punctuation">:</span> <span class="token punctuation">{</span> immediate<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> delay<span class="token punctuation">:</span> <span class="token number">500</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><p>Then you have to start request:</p><pre class="language-javascript"><code><span class="token comment">/* All requests will be started after 500ms */</span>
delayed<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
delayed<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
delayed<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
delayed<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
delayed<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><h4 id="request-timeout"><a href="#request-timeout" aria-hidden="true" class="header-anchor">#</a> Request timeout</h4><p>When you need to define time limitations for requests, you can use <code>options.timeout</code> option</p><pre class="language-javascript"><code><span class="token comment">/* If request lasts more than 500ms, it will be .cancel()'ed */</span>
<span class="token keyword">const</span> request <span class="token operator">=</span> <span class="token function">doRequest</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token punctuation">:</span> <span class="token string">'/foo/bar'</span><span class="token punctuation">,</span>
  options<span class="token punctuation">:</span> <span class="token punctuation">{</span> timeout<span class="token punctuation">:</span> <span class="token number">500</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><p>If time is out, <code>request.cancel()</code> is called (<code>cancel</code> event is fired too)</p><h4 id="start-event"><a href="#start-event" aria-hidden="true" class="header-anchor">#</a> Start event</h4><pre class="language-javascript"><code>request<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'start'</span><span class="token punctuation">,</span> state <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><p>Condition of <code>start</code> emitting:</p><ul><li>If <code>immediate</code> is <code>true</code>, it's not fired</li><li>If <code>delay</code> is defined, fires event after delay</li><li>If <code>debounce</code> is defined, fires event after delay</li></ul></div><!----><div class="content page-nav"><p class="inner"><span class="prev">
        ‚Üê <a href="/deprecated/queues.html" class="prev">
          Requests queues
        </a></span><!----></p></div></div></div></div>
    <script src="/assets/js/4.63f4dde3.js" defer></script><script src="/assets/js/app.8395491c.js" defer></script>
  </body>
</html>
